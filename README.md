# winforms2gtk
winforms2gtk, a program to help in the conversion of Windows Forms to Glade, the GTK UID
========================================================================================

This is a program to help in the conversion of Visual Basic Microsoft Windows Forms 
to Glade, the GTK User Interface Designer tool.

Windows provides Visual Studio as a Rapid Application Development tool including its 
User Interface Designer. For each window, several files are produced, defining a 
Windows Form. The goal of winforms2gtk is to help in the translation of these files to glade
format (XML), such that the output can be used in GTK applications.

Dependencies
------------

You should have the following tools installed:

- The GNAT Ada Compilation System, including GNAT Studio. Ada Core Technologies (ACT) 
Community editions are OK.
- GTK Libraries.
- Glade.


Building winforms2gtk
---------------------
Once downloaded, just double-click on w2gtk.gpr and build it inside GNAT Studio.

You can change compilation/building options in w2gtk.gpr if you wish. Initially, the
switches are those used by ACT in their programs.


Using winforms2gtk
------------------
The best way is to use a shell script to convert all windows forms of an application.

Switches that are accepted by winforms2gtk:

- -rp windows forms path
- -rf windows forms name with no extension
- -gp path where place the generated files
- -gf name (with no extension) of the generated files
- -glade generate the glade file
- -dump produce a dump of the windows and widgets
- -debug produce lots of messages when progressing in the translation
- -h or --help help

Mechanics of the translation
----------------------------
A Windows Forms is described in three files:

- The Designer file (ending in .Designer.vb)
- The Resource file (ending in .resx)
- The Visual Basic code (ending in .vb)

winforms2gtk starts by parsing some parts of the Designer to identify windows and widgets. Then it
continues parsing the Resource file to get the majority of attributes or properties. It
come back again to the Designer to complete the attributes and continues to partially parse
the Visual Basic code to identify the handlers.

Then, winforms2gtk generates a dump of the information (ending in .dump) or it generates the XML
file (ending in .glade) containing the glade definition of the GTK windows and widgets.

Note that parsing is no complete and may fail. It covers the most usual writings only. A 
complete parser for these files is considered out-of-scope.

Also note that, in general, Windows Forms use relative position of elements whilst GTK
is more oriented to automatic placement by using boxes. Converting relative position to
automatic placement is not even attempted. Instead, an intermediate GTKFixed box is 
generated, where the Windows Forms elements are then placed using the specific location
and size.

The result is not perfect except in some non-complicated forms. In any case, it was
said in the title of this README.md that winforms2gtk is a tool TO HELP in the conversion.
In the glade file generated by winforms2gtk you should fine-tune the positions to get a 
correct visual impression of the window. Sorry for that. Or even better, replace the GtkFixed
by automatic positioning Gtk Widgets such as GtkBox.

Currently the generated GTK windows are:

- GtkWindow
- GtkFileChooserDialog
- GtkFileFilter
- GtkEntryBuffer,
- GtkListStore

Also currently the generated GTK widgets are:

- GtkLabel 
- GtkEntry
- GtkComboBox
- GtkButton 
- GtkRadioButton 
- GtkCheckButton
- GtkToggleButton
- GtkImage 
- GtkSpinButton
- GtkFrame
- GtkStatusBar 
- GtkFileChooserButton
- GtkToolTip 
- GtkCalendar,
- GtkColorButton
- GtkToolBar
- Windows Forms ListBox

In addition, several Windows Forms elements are accepted however code is not generated:

- PrintDocument
- PrintDialog
- FolderBrowserDialog
- ToolStripStatusLabel

This is a work in progress. Pending items to convert are:

- Menu
- Treeview

And also some of the generated widgets merit an improvement.

It is also the intention to automatically generate the Ada specs as well the body skeleton
for the GTK Callbacks of these windows and widgets.

Bug reports
-----------
Please send questions and bug reports to the author. Of course, any help/contributions are
welcome.
